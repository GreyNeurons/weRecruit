{%extends "app_header.html" %}
{%block content%}
<div class="body-background">
  <div class="job-position">
    <div class="container">
      <section class="section topbar-title">
        <h1 class="title">Job Browser</h1>
        <h2 class="subtitle">
          Browse through existing postings & various steps like shortlisting candidates or
          updating status of each job posting.
        </h2>
        {% include '/utils/show_timed_msg.html'%}
      </section>
    </div>
  </div>
  <div class="job-position table-height">
    <div class="container">
      <section class="application-form">
        <div class="table-container">

          <table class="table is-fullwidth">

            {% for jd in jdList %}
            {%if loop.first %}

            <thead>
              <tr class="header">

                <th style="color: #8c8c8c;">Client<span style="margin-left: 10px;">
                    <form id="sort_client" action="/jd/showAllPage" style="display: inline;" onsubmit="onclientSubmit">
                      <input type="hidden" name="order_by" value="client">
                      <input type="hidden" name="order" value="{{toggles.client.orderToggle}}">
                      <!-- {{toggles}} -->
                      <a href="" onclick="sortByClient()">
                        <i class="{{toggles.client.arrowToggle}}"></i></a>
                    </form>
                    <script>
                      const onclientSubmit = (e) => {
                        e.preventDefault();

                      }
                      const sortByClient = (e) => {
                        document.getElementById("sort_client").submit();
                      }
                    </script>
                  </span>
                </th>
                <th style="color: #8c8c8c;">Status <span style="margin-left: 10px;">
                    <form id="sort_status" action="/jd/showAllPage" style="display: inline;">
                      <input type="hidden" name="order_by" value="status">
                      <input type="hidden" name="order" value="{{toggles.status.orderToggle}}">

                      <script>
                        function sortByStatus() {
                          document.getElementById("sort_status").submit();
                        }
                      </script>
                      <a href="" onclick="sortByStatus()">
                        <i class="{{toggles.status.arrowToggle}}"></i> </a>
                    </form>
                  </span>
                </th>
                <th style="color: #8c8c8c;">Title <span style="margin-left: 10px;">
                    <form id="sort_title" action="/jd/showAllPage" style="display: inline;">
                      <input type="hidden" name="order_by" value="title">
                      <input type="hidden" name="order" value="{{toggles.title.orderToggle}}">

                      <script>
                        function sortByTitle() {
                          document.getElementById("sort_title").submit();
                        }
                      </script>
                      <a href="" onclick="sortByTitle()">
                        <i class="{{toggles.title.arrowToggle}}"></i> </a>
                    </form>
                  </span>
                </th>
                <th style="color: #8c8c8c;">Open Date <span style="margin-left: 10px;">
                    <form id="sort_open_date" action="/jd/showAllPage" style="display: inline;">
                      <input type="hidden" name="order_by" value="open_date">
                      <input type="hidden" name="order" value="{{toggles.open_date.orderToggle}}">

                      <script>
                        function sortByOpenDate() {
                          document.getElementById("sort_open_date").submit();
                        }
                      </script>
                      <a href="" onclick="sortByOpenDate()">
                        <i class="{{toggles.open_date.arrowToggle}}"></i> </a>
                    </form>
                  </span>
                </th>
                <th style="color: #8c8c8c;">Hiring Manager <span style="margin-left: 10px;">
                    <form id="sort_hiring_manager" action="/jd/showAllPage" style="display: inline;">
                      <input type="hidden" name="order_by" value="hiring_mgr_name">
                      <input type="hidden" name="order" value="{{toggles.hiring_mgr_name.orderToggle}}">

                      <script>
                        function sortByHRManager() {
                          document.getElementById("sort_hiring_manager").submit();
                        }
                      </script>
                      <a href="" onclick="sortByHRManager()">
                        <i class="{{toggles.hiring_mgr_name.arrowToggle}}"></i></a>
                    </form>
                  </span>
                </th>
                <th style="color: #8c8c8c;">Actions</th>
              </tr>
            </thead>
            {% endif %}
            <tbody>
              <tr class="table-data">
                <td>{{jd.client}}</td>
                {%if jd.status == 0 %}
                <td>Open</td>
                {% endif %}
                {%if jd.status == 1 %}
                <td>Draft</td>
                {% endif %}
                {%if jd.status == 2 %}
                <td>Closed</td>
                {% endif %}

                <td>{{jd.title}}</td>
                <td>{{ jd.open_date.strftime("%Y-%b-%d") }}</td>
                <td>{{ jd.hiring_mgr_name }}</td>
                <td>
                  <a href="/jd/showShortlistPage/{{jd.id}}"><abbr title="Shortlist candidates"><i
                        class="fa fa-thumbs-o-up"></i></abbr></a>
                  <span style="margin-left: 20px;"><a href="/jd/showWorkPage/{{jd.id}}"><abbr
                        title="View Shortlisted candidates"><i class="fa fa-search"></i></abbr></a></span>
                  <span style="margin-left: 20px;"><a href="/jd/showSummaryPage/{{jd.id}}"><abbr
                        title="View Status Summary"><i class="fa fa-file-text"></i></abbr></a></span>
                  <span style="margin-left: 20px;"><a href="/jd/showEditPage/{{jd.id}}"><abbr title="Edit"><i
                          class="fa fa-pencil-square-o"></i></abbr></a></span>
                  <span style="margin-left: 20px;"><a href="/jd/download/{{jd.id}}"><abbr title="Download Client JD"><i
                          class="fa fa-download"></i></abbr></a></span>
                </td>
              </tr>
              {% else %}
              <div class="notification is-warning">
                No JDs found !!!
              </div>
              {% endfor %}
            </tbody>
          </table>
          <!-- pagination code -->
          <div style="margin-left: 90%;">
            <ul style="display: flex;">
              <div style="flex-direction: row;">
                <li style="flex: content;"><a>{{pagination.page}} <span class="sr-only">(current)</span></a></li>
                <li><a>Of {{pagination.total}} <span class="sr-only">(current)</span></a></li>
                <li><a class="page-link"
                    href="/jd/showAllPage?page={{pagination.page - 1}}&per_page={{pagination.per_page}}"
                    aria-label="Next"><span>&laquo;</span><span class="sr-only">Next</span></a></li>
                </li>
                <li><a class="page-link"
                    href="/jd/showAllPage?page={{pagination.page + 1}}&per_page={{pagination.per_page}}"
                    aria-label="Next"><span>&raquo;</span><span class="sr-only">Next</span></a></li>
              </div>
            </ul>
          </div>



      </section>
    </div>
  </div>
</div>
{% endblock %}